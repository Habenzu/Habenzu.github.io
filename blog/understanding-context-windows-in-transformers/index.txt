1:"$Sreact.fragment"
2:I[7113,["489","static/chunks/489-ea0ef55f20694aef.js","898","static/chunks/898-bfb6bde89cc72103.js","333","static/chunks/333-0e935ee820a7e8d1.js","177","static/chunks/app/layout-09742822af577269.js"],"ThemeProvider"]
3:I[1023,["489","static/chunks/489-ea0ef55f20694aef.js","898","static/chunks/898-bfb6bde89cc72103.js","333","static/chunks/333-0e935ee820a7e8d1.js","177","static/chunks/app/layout-09742822af577269.js"],"Header"]
4:I[5244,[],""]
5:I[3866,[],""]
6:I[2985,["489","static/chunks/489-ea0ef55f20694aef.js","898","static/chunks/898-bfb6bde89cc72103.js","333","static/chunks/333-0e935ee820a7e8d1.js","177","static/chunks/app/layout-09742822af577269.js"],"Footer"]
7:I[4547,[],"ClientSegmentRoot"]
8:I[7173,["489","static/chunks/489-ea0ef55f20694aef.js","898","static/chunks/898-bfb6bde89cc72103.js","584","static/chunks/app/blog/layout-5fdda78b3adb5bb6.js"],"default"]
a:I[3213,["489","static/chunks/489-ea0ef55f20694aef.js","595","static/chunks/app/blog/understanding-context-windows-in-transformers/page-b5675bbb64a58209.js"],"BlogTiltCard"]
b:I[6213,[],"OutletBoundary"]
d:I[6213,[],"MetadataBoundary"]
f:I[6213,[],"ViewportBoundary"]
11:I[4835,[],""]
:HL["/_next/static/media/569ce4b8f30dc480-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/media/93f479601ee12b01-s.p.woff2","font",{"crossOrigin":"","type":"font/woff2"}]
:HL["/_next/static/css/7a4c365e2abf6247.css","style"]
:HL["/_next/static/css/09dfadb69bdaa005.css","style"]
:HL["/_next/static/css/219277c719a6eddd.css","style"]
0:{"P":null,"b":"BE3RN10e5fvhc_uOlQ7PA","p":"","c":["","blog","understanding-context-windows-in-transformers",""],"i":false,"f":[[["",{"children":["blog",{"children":["understanding-context-windows-in-transformers",{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/7a4c365e2abf6247.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/09dfadb69bdaa005.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}],["$","link","2",{"rel":"stylesheet","href":"/_next/static/css/219277c719a6eddd.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_5cfdac __variable_9a8899 bg-white tracking-tight antialiased dark:bg-zinc-950","children":["$","$L2",null,{"enableSystem":false,"attribute":"class","storageKey":"theme","defaultTheme":"dark","children":["$","div",null,{"className":"flex min-h-screen w-full flex-col font-[family-name:var(--font-inter-tight)]","children":["$","div",null,{"className":"relative mx-auto w-full max-w-screen-sm flex-1 px-4 pt-20","children":[["$","$L3",null,{}],["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[],["$","div",null,{"className":"text-center","children":[["$","h1",null,{"children":"404 - Page Not Found"}],["$","p",null,{"children":"The page you are looking for does not exist."}]]}]],"forbidden":"$undefined","unauthorized":"$undefined"}],["$","$L6",null,{}]]}]}]}]}]}]]}],{"children":["blog",["$","$1","c",{"children":[null,["$","$L7",null,{"Component":"$8","slots":{"children":["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]},"params":{},"promise":"$@9"}]]}],{"children":["understanding-context-windows-in-transformers",["$","$1","c",{"children":[null,["$","$L4",null,{"parallelRouterKey":"children","segmentPath":["children","blog","children","understanding-context-windows-in-transformers","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":[[["$","$La",null,{"imageSrc":"/blog-covers/understanding-context-windows-in-transformers.jpg","imageAlt":"Image of Nijak in Sweden, Sarek Nationalpark","title":"Nijak (Sweden)","subtitle":"67.49523758424495, 17.48655966079439","fullWidth":"true"}],"\n",["$","h1",null,{"children":"Understanding Context Windows in Transformers: From Attention to Memory Limits - 15.07.2025"}],"\n",["$","p",null,{"children":["$","em",null,{"children":"A slightly‑nerdy but still coffee‑chat‑friendly dive into how Transformers remember stuff - and why they eventually forget."}]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":[["$","strong",null,{"children":"Friendly Disclaimer:"}]," I’m writing these notes mostly to clarify the ideas in my own head. While I’ve done my best to be accurate, please treat every claim here with a healthy pinch of skepticism. Nothing in this post should be taken as definitive, peer‑reviewed truth-just one nerd’s working understanding on a journey to learn."]}],"\n"]}],"\n",["$","h2",null,{"children":"1 · Speed‑run refresher: the Transformer in 90 seconds"}],"\n",["$","p",null,{"children":"In 2017, Vaswani et al. (1) replaced the step‑by‑step processing of RNNs with a fully‑parallel \"self‑attention\" encoder/decoder stack, slashing training time and unlocking massive scale. Each layer does three things in a sandwich:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"multi‑head self‑attention"}],"\n",["$","li",null,{"children":"a position‑wise feed‑forward network, and"}],"\n",["$","li",null,{"children":"layer‑norm + residual skips."}],"\n"]}],"\n",["$","p",null,{"children":"Everything in the sandwich is matrix math, so GPUs / TPUs can chew through thousands of tokens at once (for more details have a look in (2))."}],"\n",["$","h2",null,{"children":"2 · Self‑attention, spelled out"}],"\n",["$","p",null,{"children":["At its core, attention answers: ",["$","em",null,{"children":"\"Which words (or tokens) should I pay attention to when processing this token?\""}],". Instead of processing tokens one by one like RNNs, attention lets every token look at all others (well, within the context window). That's the self-attention part in transformers. More formally the attnetion head allows us to distinctly represent the three different roles each of the token embeddings play during the process of self-attention:"]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":[["$","strong",null,{"children":"Query"}],": Its role as ",["$","em",null,{"children":"current element"}]," which gets compared to preceding inputs."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Key"}],": Its role as ",["$","em",null,{"children":"preceding input"}]," which is compared to the current element to determine the similarity weighting."]}],"\n",["$","li",null,{"children":[["$","strong",null,{"children":"Value"}],": Its role as a ",["$","em",null,{"children":"value"}]," of the preceding elements which gets weuighted and summed up to compute the output for the current element."]}],"\n"]}],"\n",["$","p",null,{"children":"Instead of iterating token by token, we process the entire sequence in one go using matrices which represent those three different roles:"}],"\n",["$","span",null,{"className":"katex-display","children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","display":"block","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"Q"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"X"}],["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"Q"}]]}],["$","mo",null,{"separator":"true","children":";"}],["$","mi",null,{"children":"K"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"X"}],["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"K"}]]}],["$","mo",null,{"separator":"true","children":";"}],["$","mi",null,{"children":"V"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"X"}],["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"V"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"Q=XW^{Q}; K=XW^{K}; V=XW^{V}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8778em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"Q"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.0858em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07847em"},"children":"X"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8913em"},"children":["$","span",null,{"style":{"top":"-3.113em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"Q"}]}]}]]}]}]}]}]}]]}],["$","span",null,{"className":"mpunct","children":";"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.0858em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07847em"},"children":"X"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8913em"},"children":["$","span",null,{"style":{"top":"-3.113em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.07153em"},"children":"K"}]}]}]]}]}]}]}]}]]}],["$","span",null,{"className":"mpunct","children":";"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.22222em"},"children":"V"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8913em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07847em"},"children":"X"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8913em"},"children":["$","span",null,{"style":{"top":"-3.113em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.22222em"},"children":"V"}]}]}]]}]}]}]}]}]]}]]}]]}]]}]}],"\n",["$","p",null,{"children":["Where ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"Q"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"W^{Q}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8413em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8413em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","children":"Q"}]}]}]]}]}]}]}]}]]}]]}]}]]}]," is of shape ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"d"}],["$","mo",null,{"children":"×"}],["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(d\\times d_k)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"×"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3361em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}],", ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"K"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"W^{K}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8413em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8413em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.07153em"},"children":"K"}]}]}]]}]}]}]}]}]]}]]}]}]]}]," of shape ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"d"}],["$","mo",null,{"children":"×"}],["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(d\\times d_k)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"×"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3361em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}],", ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"v"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"W^{v}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.6644em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03588em"},"children":"v"}]}]}]]}]}]}]}]}]]}]]}]}]]}]," of shape ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"d"}],["$","mo",null,{"children":"×"}],["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"v"}]]}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(d\\times d_v)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"×"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.1514em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03588em"},"children":"v"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}]," and ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"X"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"X"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07847em"},"children":"X"}]]}]}]]}]," is of shape ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"N"}],["$","mo",null,{"children":"×"}],["$","mi",null,{"children":"s"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(N\\times s)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"×"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","children":"s"}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}],"."]}],"\n",["$","p",null,{"children":["With those three matrices we can now compute all the needed query-key comparisons in one go by multiplying ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"Q"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"Q"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8778em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"Q"}]]}]}]]}]," and ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mi",null,{"children":"K"}],["$","mo",null,{"mathvariant":"normal","lspace":"0em","rspace":"0em","children":"′"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"K'"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.7519em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.7519em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"′"}]}]}]]}]}]}]}]}]]}]]}]}]]}],", the product is then of shape ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"N"}],["$","mo",null,{"children":"×"}],["$","mi",null,{"children":"N"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(N\\times N)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"×"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}],". Once we have this we can rather efficiently scale the those scores, take the softmax and multiplying the result with ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"V"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"V"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.22222em"},"children":"V"}]]}]}]]}],"."]}],"\n",["$","span",null,{"className":"katex-display","children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","display":"block","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mtext",null,{"children":"head"}],["$","mo",null,{"children":"="}],["$","mtext",null,{"children":"softmax"}],["$","mtext",null,{"children":" ⁣"}],["$","mrow",null,{"children":[["$","mo",null,{"fence":"true","children":"("}],["$","mtext",null,{"children":"mask"}],["$","mtext",null,{"children":" ⁣"}],["$","mrow",null,{"children":[["$","mo",null,{"fence":"true","children":"("}],["$","mfrac",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"Q"}],["$","msup",null,{"children":[["$","mi",null,{"children":"K"}],["$","mo",null,{"mathvariant":"normal","lspace":"0em","rspace":"0em","children":"′"}]]}]]}],["$","msqrt",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}]}]]}],["$","mo",null,{"fence":"true","children":")"}]]}],["$","mo",null,{"fence":"true","children":")"}]]}],["$","mspace",null,{"linebreak":"newline"}],["$","mi",null,{"children":"A"}],["$","mo",null,{"children":"="}],["$","mtext",null,{"children":"head"}],["$","msup",null,{"children":[["$","mi",null,{"children":"W"}],["$","mi",null,{"children":"O"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\text{head}=\\text{softmax}\\!\\left(\\text{mask}\\!\\left(\\frac{QK'}{\\sqrt{d_k}}\\right)\\right) \\\\\nA = \\text{head}W^{O}"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6944em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"head"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"2.4em","verticalAlign":"-0.95em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"softmax"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"-0.1667em"}}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"minner","children":[["$","span",null,{"className":"mopen delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size3","children":"("}]}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"mask"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"-0.1667em"}}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"minner","children":[["$","span",null,{"className":"mopen delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size3","children":"("}]}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mopen nulldelimiter"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"1.4289em"},"children":[["$","span",null,{"style":{"top":"-2.2528em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord","children":["$","span",null,{"className":"mord sqrt","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8572em"},"children":[["$","span",null,{"className":"svg-align","style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord","style":{"paddingLeft":"0.833em"},"children":["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3361em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]}]]}],["$","span",null,{"style":{"top":"-2.8172em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"hide-tail","style":{"minWidth":"0.853em","height":"1.08em"},"children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":"400em","height":"1.08em","viewBox":"0 0 400000 1080","preserveAspectRatio":"xMinYMin slice","children":["$","path",null,{"d":"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}]}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1828em"},"children":["$","span",null,{}]}]}]]}]}]}]]}],["$","span",null,{"style":{"top":"-3.23em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line","style":{"borderBottomWidth":"0.04em"}}]]}],["$","span",null,{"style":{"top":"-3.677em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"Q"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.7519em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"′"}]}]}]]}]}]}]}]}]]}]]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.93em"},"children":["$","span",null,{}]}]}]]}]}],["$","span",null,{"className":"mclose nulldelimiter"}]]}],["$","span",null,{"className":"mclose delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size3","children":")"}]}]]}],["$","span",null,{"className":"mclose delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size3","children":")"}]}]]}]]}],["$","span",null,{"className":"mspace newline"}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","children":"A"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8913em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"head"}]}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.13889em"},"children":"W"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8913em"},"children":["$","span",null,{"style":{"top":"-3.113em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.02778em"},"children":"O"}]}]}]]}]}]}]}]}]]}]]}]]}]]}]}],"\n",["$","blockquote",null,{"children":["\n",["$","p",null,{"children":[["$","em",null,{"children":"Note:"}]," ",["$","br",null,{}],"\n",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"d"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"d"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6944em"}}],["$","span",null,{"className":"mord mathnormal","children":"d"}]]}]}]]}]," - model dimension",["$","br",null,{}],"\n",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"d_k"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8444em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3361em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}]," - embedding dimension of the query and key",["$","br",null,{}],"\n",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"v"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"d_v"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8444em","verticalAlign":"-0.15em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.1514em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03588em"},"children":"v"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}]]}]}]]}]," - embedding dimension of the value",["$","br",null,{}],"\n",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","msup",null,{"children":[["$","mi",null,{"children":"Z"}],["$","mo",null,{"mathvariant":"normal","lspace":"0em","rspace":"0em","children":"′"}]]}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"Z'"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.7519em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"Z"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.7519em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"′"}]}]}]]}]}]}]}]}]]}]]}]}]]}]," - transpose of ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"Z"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"Z"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"Z"}]]}]}]]}],["$","br",null,{}],"\n",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"A"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"A"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","children":"A"}]]}]}]]}]," - Attention matrix"]}],"\n"]}],"\n",["$","h2",null,{"children":"3 · Why GPUs love this: pure matrix ops"}],"\n",["$","p",null,{"children":["As layed out a single attention head is computed in three dense‐matrix steps, prjection of the embeddings (calculation of ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"Q"}],["$","mo",null,{"separator":"true","children":","}],["$","mi",null,{"children":"K"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"Q, K"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.8778em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"Q"}],["$","span",null,{"className":"mpunct","children":","}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"K"}]]}]}]]}]," and ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"V"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"V"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.22222em"},"children":"V"}]]}]}]]}],"), calculation of the similarity across all pairs ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mtext",null,{"children":" ⁣"}],["$","mrow",null,{"children":[["$","mo",null,{"fence":"true","children":"("}],["$","mi",null,{"children":"S"}],["$","mo",null,{"children":"="}],["$","mfrac",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"Q"}],["$","msup",null,{"children":[["$","mi",null,{"children":"K"}],["$","mo",null,{"mathvariant":"normal","lspace":"0em","rspace":"0em","children":"′"}]]}]]}],["$","msqrt",null,{"children":["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}]}]]}],["$","mo",null,{"fence":"true","children":")"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\!\\left(S = \\frac{QK'}{\\sqrt{d_k}}\\right)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.8em","verticalAlign":"-0.65em"}}],["$","span",null,{"className":"mspace","style":{"marginRight":"-0.1667em"}}],["$","span",null,{"className":"minner","children":[["$","span",null,{"className":"mopen delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size2","children":"("}]}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.05764em"},"children":"S"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mopen nulldelimiter"}],["$","span",null,{"className":"mfrac","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"1.0256em"},"children":[["$","span",null,{"style":{"top":"-2.5864em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord sqrt mtight","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.8622em"},"children":[["$","span",null,{"className":"svg-align","style":{"top":"-3em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"mord mtight","style":{"paddingLeft":"0.833em"},"children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3448em"},"children":["$","span",null,{"style":{"top":"-2.3488em","marginLeft":"0em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1512em"},"children":["$","span",null,{}]}]}]]}]}]]}]}]]}],["$","span",null,{"style":{"top":"-2.8222em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"hide-tail mtight","style":{"minWidth":"0.853em","height":"1.08em"},"children":["$","svg",null,{"xmlns":"http://www.w3.org/2000/svg","width":"400em","height":"1.08em","viewBox":"0 0 400000 1080","preserveAspectRatio":"xMinYMin slice","children":["$","path",null,{"d":"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}]}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.1778em"},"children":["$","span",null,{}]}]}]]}]}]}]}]]}],["$","span",null,{"style":{"top":"-3.23em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"frac-line","style":{"borderBottomWidth":"0.04em"}}]]}],["$","span",null,{"style":{"top":"-3.4461em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"3em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","children":"Q"}],["$","span",null,{"className":"mord mtight","children":[["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8278em"},"children":["$","span",null,{"style":{"top":"-2.931em","marginRight":"0.0714em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.5em"}}],["$","span",null,{"className":"sizing reset-size3 size1 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"′"}]}]}]]}]}]}]}]}]]}]]}]}]]}]]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.538em"},"children":["$","span",null,{}]}]}]]}]}],["$","span",null,{"className":"mclose nulldelimiter"}]]}],["$","span",null,{"className":"mclose delimcenter","style":{"top":"0em"},"children":["$","span",null,{"className":"delimsizing size2","children":")"}]}]]}]]}]}]]}],"and masking, softmax and mixing with the values ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mtext",null,{"children":" ⁣"}],["$","mrow",null,{"children":[["$","mo",null,{"fence":"true","children":"("}],["$","mtext",null,{"children":"head"}],["$","mo",null,{"children":"="}],["$","mtext",null,{"children":"softmax"}],["$","mtext",null,{"children":" ⁣"}],["$","mrow",null,{"children":[["$","mo",null,{"fence":"true","children":"("}],["$","mtext",null,{"children":"mask"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"S"}],["$","mo",null,{"stretchy":"false","children":")"}],["$","mo",null,{"fence":"true","children":")"}]]}],["$","mi",null,{"children":"V"}],["$","mo",null,{"fence":"true","children":")"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"\\!\\left(\\text{head} = \\text{softmax}\\!\\left( \\text{mask}(S) \\right)V\\right)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mspace","style":{"marginRight":"-0.1667em"}}],["$","span",null,{"className":"minner","children":[["$","span",null,{"className":"mopen delimcenter","style":{"top":"0em"},"children":"("}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"head"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"softmax"}]}],["$","span",null,{"className":"mspace","style":{"marginRight":"-0.1667em"}}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"minner","children":[["$","span",null,{"className":"mopen delimcenter","style":{"top":"0em"},"children":"("}],["$","span",null,{"className":"mord text","children":["$","span",null,{"className":"mord","children":"mask"}]}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.05764em"},"children":"S"}],["$","span",null,{"className":"mclose","children":")"}],["$","span",null,{"className":"mclose delimcenter","style":{"top":"0em"},"children":")"}]]}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.1667em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.22222em"},"children":"V"}],["$","span",null,{"className":"mclose delimcenter","style":{"top":"0em"},"children":")"}]]}]]}]}]]}],". GPUs love this because all the work can be fused into a handful of highly‑optimized kernels, so the whole sequence is processed in parallel instead of in basic loop. Per layer the arithmetic cost is"]}],"\n",["$","span",null,{"className":"katex-display","children":["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","display":"block","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"O"}],["$","mo",null,{"stretchy":"false","children":"("}],["$","msup",null,{"children":[["$","mi",null,{"children":"N"}],["$","mn",null,{"children":"2"}]]}],["$","msub",null,{"children":[["$","mi",null,{"children":"d"}],["$","mi",null,{"children":"k"}]]}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"O(N^2d_k)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1.1141em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.02778em"},"children":"O"}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.8641em"},"children":["$","span",null,{"style":{"top":"-3.113em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":"2"}]}]]}]}]}]}]}]]}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","children":"d"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t vlist-t2","children":[["$","span",null,{"className":"vlist-r","children":[["$","span",null,{"className":"vlist","style":{"height":"0.3361em"},"children":["$","span",null,{"style":{"top":"-2.55em","marginLeft":"0em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mathnormal mtight","style":{"marginRight":"0.03148em"},"children":"k"}]}]]}]}],["$","span",null,{"className":"vlist-s","children":"​"}]]}],["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.15em"},"children":["$","span",null,{}]}]}]]}]}]]}],["$","span",null,{"className":"mclose","children":")"}]]}]}]]}]}],"\n",["$","p",null,{"children":"yet the wall‑clock time stays sane because everything sits in fast on‑chip RAM during the mawtrix multiplication."}],"\n",["$","h2",null,{"children":"4 · What Puts a Ceiling on the Context Window?"}],"\n",["$","p",null,{"children":["Look at the similarity matrix ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mi",null,{"children":"S"}],["$","mo",null,{"children":"="}],["$","mi",null,{"children":"Q"}],["$","msup",null,{"children":[["$","mi",null,{"children":"K"}],["$","mo",null,{"mathvariant":"normal","lspace":"0em","rspace":"0em","children":"′"}]]}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"S=QK'"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.05764em"},"children":"S"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}],["$","span",null,{"className":"mrel","children":"="}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2778em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.9463em","verticalAlign":"-0.1944em"}}],["$","span",null,{"className":"mord mathnormal","children":"Q"}],["$","span",null,{"className":"mord","children":[["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.07153em"},"children":"K"}],["$","span",null,{"className":"msupsub","children":["$","span",null,{"className":"vlist-t","children":["$","span",null,{"className":"vlist-r","children":["$","span",null,{"className":"vlist","style":{"height":"0.7519em"},"children":["$","span",null,{"style":{"top":"-3.063em","marginRight":"0.05em"},"children":[["$","span",null,{"className":"pstrut","style":{"height":"2.7em"}}],["$","span",null,{"className":"sizing reset-size6 size3 mtight","children":["$","span",null,{"className":"mord mtight","children":["$","span",null,{"className":"mord mtight","children":"′"}]}]}]]}]}]}]}]}]]}]]}]]}]]}],":"]}],"\n",["$","div",null,{"className":"overflow-x-auto my-6","children":["$","table",null,{"className":"min-w-full divide-y divide-gray-200","children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"className":"px-4 py-2 text-left","children":"Sequence length N"}],["$","th",null,{"className":"px-4 py-2 text-left","children":"Elements in S"}],["$","th",null,{"className":"px-4 py-2 text-left","children":"Memory (bfloat16)"}]]}]}],["$","tbody",null,{"className":"divide-y divide-gray-200","children":[["$","tr",null,{"children":[["$","td",null,{"className":"px-4 py-2","children":"512"}],["$","td",null,{"className":"px-4 py-2","children":"262,144"}],["$","td",null,{"className":"px-4 py-2","children":"≈ 1 MB"}]]}],["$","tr",null,{"children":[["$","td",null,{"className":"px-4 py-2","children":"4,096"}],["$","td",null,{"className":"px-4 py-2","children":"16.8 M"}],["$","td",null,{"className":"px-4 py-2","children":"≈ 64 MB"}]]}],["$","tr",null,{"children":[["$","td",null,{"className":"px-4 py-2","children":"32,768"}],["$","td",null,{"className":"px-4 py-2","children":"1.07 B"}],["$","td",null,{"className":"px-4 py-2","children":"≈ 4 GB"}]]}]]}]]}]}],"\n",["$","p",null,{"children":["Because ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"S"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"S"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.05764em"},"children":"S"}]]}]}]]}]," is of shape ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":[["$","mo",null,{"stretchy":"false","children":"("}],["$","mi",null,{"children":"N"}],["$","mo",null,{"children":"×"}],["$","mi",null,{"children":"N"}],["$","mo",null,{"stretchy":"false","children":")"}]]}],["$","annotation",null,{"encoding":"application/x-tex","children":"(N\\times N)"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":[["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mopen","children":"("}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}],["$","span",null,{"className":"mbin","children":"×"}],["$","span",null,{"className":"mspace","style":{"marginRight":"0.2222em"}}]]}],["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"1em","verticalAlign":"-0.25em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}],["$","span",null,{"className":"mclose","children":")"}]]}]]}]]}],", memory (and compute) grows ",["$","em",null,{"children":"quadratically"}]," with the number of tokens. Those figures are per head, per layer; stack 32 heads over 48 layers and even an 80 GB A100 taps out fast."]}],"\n",["$","p",null,{"children":["During training you therefore pick a maximum ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"N"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"N"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}]]}]}]]}]," that fits on the hardware, train the positional encodings for exactly that span, and accept that as the model's context window at inference time. Push ",["$","span",null,{"className":"katex","children":[["$","span",null,{"className":"katex-mathml","children":["$","math",null,{"xmlns":"http://www.w3.org/1998/Math/MathML","children":["$","semantics",null,{"children":[["$","mrow",null,{"children":["$","mi",null,{"children":"N"}]}],["$","annotation",null,{"encoding":"application/x-tex","children":"N"}]]}]}]}],["$","span",null,{"className":"katex-html","aria-hidden":"true","children":["$","span",null,{"className":"base","children":[["$","span",null,{"className":"strut","style":{"height":"0.6833em"}}],["$","span",null,{"className":"mord mathnormal","style":{"marginRight":"0.10903em"},"children":"N"}]]}]}]]}]," higher and the attention matrix simply won’t fit-unless you adopt one of the sparsity, linear‑attention, or caching tricks listed in section 5."]}],"\n",["$","h2",null,{"children":"References"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["(1) - ",["$","a",null,{"href":"https://proceedings.neurips.cc/paper_files/paper/2017/file/3f5ee243547dee91fbd053c1c4a845aa-Paper.pdf","children":"Attention Is All You Need"}]]}],"\n",["$","li",null,{"children":["(2) - ",["$","a",null,{"href":"https://web.stanford.edu/~jurafsky/slp3/9.pdf","children":"Speech and Language Processing. Daniel Jurafsky & James H. Martin"}]]}],"\n"]}],"\n",["$","hr",null,{}],"\n",["$","p",null,{"children":"15.07.2025"}]],null,["$","$Lb",null,{"children":"$Lc"}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,["$","$1","dJCgxOK7FjT51lZdF9US9",{"children":[["$","$Ld",null,{"children":"$Le"}],["$","$Lf",null,{"children":"$L10"}],["$","meta",null,{"name":"next-size-adjust","content":""}]]}]]}],false]],"m":"$undefined","G":["$11","$undefined"],"s":false,"S":true}
9:{}
10:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"name":"theme-color","content":"#ffffff"}]]
e:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Understanding Context Windows in Transformers: From Attention to Memory Limits | PvH"}],["$","meta","2",{"name":"description","content":"Understanding how transformers process information reveals the crucial balance between computational design and model capabilities, as advances in attention mechanisms continue to push the boundaries of memory, scalability, and context."}],["$","link","3",{"rel":"canonical","href":"/blog/understanding-context-windows-in-transformers"}],["$","link","4",{"rel":"shortcut icon","href":"/favicon_2.ico"}],["$","link","5",{"rel":"icon","href":"/favicon_2.ico"}],["$","link","6",{"rel":"apple-touch-icon","href":"/favicon_2.ico"}]]
c:null
